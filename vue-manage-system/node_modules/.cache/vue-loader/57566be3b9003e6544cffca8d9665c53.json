{"remainingRequest":"D:\\imodou-blog\\vue-manage-system\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\imodou-blog\\vue-manage-system\\src\\components\\page\\article_edit.vue?vue&type=style&index=0&id=b646bc5a&scoped=true&lang=css&","dependencies":[{"path":"D:\\imodou-blog\\vue-manage-system\\src\\components\\page\\article_edit.vue","mtime":1590164653906},{"path":"D:\\imodou-blog\\vue-manage-system\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"D:\\imodou-blog\\vue-manage-system\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\imodou-blog\\vue-manage-system\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\imodou-blog\\vue-manage-system\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\imodou-blog\\vue-manage-system\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.editor-btn{\n    margin-top: 20px;\n}\n",{"version":3,"sources":["article_edit.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0MA;AACA;AACA","file":"article_edit.vue","sourceRoot":"src/components/page","sourcesContent":["<template>\r\n\r\n    <div>\r\n        <div class=\"crumbs\">\r\n            <el-breadcrumb separator=\"/\">\r\n                <el-breadcrumb-item><i class=\"el-icon-lx-calendar\"></i> 文章</el-breadcrumb-item>\r\n                <el-breadcrumb-item>编辑</el-breadcrumb-item>\r\n            </el-breadcrumb>\r\n        </div>\r\n        <div class=\"container\">\r\n           <div class=\"form-box\" style=\"width:98%\">\r\n                <el-form ref=\"form\" :model=\"form\" label-width=\"80px\">\r\n                    <el-form-item label=\"标题\">\r\n                        <el-input v-model=\"form.title\"></el-input>\r\n                    </el-form-item>\r\n                    <el-form-item label=\"摘要\">\r\n                        <el-input v-model=\"form.summary\" style=\"width:100%\"></el-input>\r\n                    </el-form-item>\r\n                              <el-form-item label=\"父类\">\r\n                    <el-cascader ref=\"categoryCascader\" :v-model=\"form.categories\"\r\n                       \r\n                        :options=\"options\"\r\n                     \r\n                        @change=\"handleChange\"   ></el-cascader>\r\n                </el-form-item>\r\n                    <el-form-item label=\"封面\">\r\n                        <div class=\"crop-demo\">\r\n                            <img :src=\"cropImg\" class=\"pre-img\" style=\"width:150px;height:100px\">\r\n                            <div class=\"crop-demo-btn\">选择图片\r\n                                <input class=\"crop-input\" type=\"file\" name=\"image\" accept=\"image/*\" @change=\"setImage\"/>\r\n                            </div>\r\n                        </div>\r\n                \r\n                        <el-dialog title=\"裁剪图片\" :visible.sync=\"dialogVisible\" width=\"30%\">\r\n                            <vue-cropper ref='cropper' :src=\"imgSrc\" :ready=\"cropImage\" :zoom=\"cropImage\" :cropmove=\"cropImage\" style=\"width:100%;height:300px;\"></vue-cropper>\r\n                            <span slot=\"footer\" class=\"dialog-footer\">\r\n                                <el-button @click=\"cancelCrop\">取 消</el-button>\r\n                                <el-button type=\"primary\" @click=\"dialogVisible = false\">确 定</el-button>\r\n                            </span>\r\n                        </el-dialog>\r\n                    </el-form-item>\r\n                </el-form>\r\n           </div>\r\n            <mavon-editor v-model=\"content\" ref=\"md\" @imgAdd=\"$imgAdd\" @change=\"change\" style=\"min-height: 600px\"/>\r\n            <el-button class=\"editor-btn\" type=\"primary\" @click=\"submit\">提交</el-button>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import { mavonEditor } from 'mavon-editor'\r\n    import 'mavon-editor/dist/css/index.css'\r\n    import VueCropper  from 'vue-cropperjs';\r\nimport Axios from 'axios';\r\n    export default {\r\n        name: 'markdown',\r\n        data: function(){\r\n            return {\r\n                content:'',\r\n                html:'',\r\n                configs: {\r\n                },\r\n                form: { \r\n                    \r\n                },\r\n                imgSrc: '',\r\n                cropImg: '',\r\n                dialogVisible: false,\r\n                defaultSrc: require('../../assets/img/img.jpg'),\r\n                options:[],\r\n            }\r\n        },\r\n        components: {\r\n            mavonEditor,\r\n            VueCropper\r\n        },\r\n        methods: {\r\n            // 将图片上传到服务器，返回地址替换到md中\r\n            $imgAdd(pos, $file){\r\n                var formdata = new FormData();\r\n                formdata.append('file', $file);\r\n                // 这里没有服务器供大家尝试，可将下面上传接口替换为你自己的服务器接口\r\n                Axios({\r\n                    url: '/api/article/upload',\r\n                    method: 'post',\r\n                    data: formdata,\r\n                    headers: { 'Content-Type': 'multipart/form-data' },\r\n                }).then((res) => {\r\n                    this.$refs.md.$img2Url(pos, res.data.data);\r\n                })\r\n            },\r\n            change(value, render){\r\n                // render 为 markdown 解析后的结果\r\n                this.html = render;\r\n            },\r\n            submit(){\r\n                // console.log(this.form);\r\n                // console.log(this.content);\r\n                // console.log(this.html);\r\n\r\n                this.form.content=this.content;\r\n                Axios.post(\"/api/article\",this.form).then((res)=>{\r\n                    if(res.data.flag){\r\n                          this.$message.success('提交成功！');\r\n                    }else{\r\n                        this.$message.error(res.data.message);\r\n                    }\r\n                    \r\n                })\r\n                \r\n\r\n              \r\n            },\r\n            setImage(e){\r\n               \r\n                const file = e.target.files[0];\r\n                \r\n                if (!file.type.includes('image/')) {\r\n                    return;\r\n                }\r\n                const reader = new FileReader();\r\n                reader.onload = (event) => {\r\n              \r\n                    this.dialogVisible = true;\r\n                    this.imgSrc = event.target.result;\r\n                    this.$refs.cropper && this.$refs.cropper.replace(event.target.result);\r\n                };\r\n                reader.readAsDataURL(file);\r\n                \r\n                let formData = new FormData()\r\n                formData.append('file',e.target.files[0])\r\n                Axios({\r\n                    url:\"/api/article/upload\",\r\n                    method: 'post',\r\n                    data: formData,\r\n                    processData: false,// 告诉axios不要去处理发送的数据(重要参数)\r\n                    contentType: false,   // 告诉axios不要去设置Content-Type请求头\r\n                }).then((res)=>{\r\n                    if(res.data.flag){\r\n                        this.form.coverPhoto=res.data.data;\r\n                    }else{\r\n                        this.$message.error(res.data.message);\r\n                    }\r\n                    \r\n                })\r\n            \r\n\r\n            },\r\n            cropImage () {\r\n                this.cropImg = this.$refs.cropper.getCroppedCanvas().toDataURL();\r\n            },\r\n            cancelCrop(){\r\n                this.dialogVisible = false;\r\n                this.cropImg = this.defaultSrc;\r\n            },\r\n            imageuploaded(res) {\r\n                console.log(res)\r\n            },\r\n            handleError(){\r\n                this.$notify.error({\r\n                    title: '上传失败',\r\n                    message: '图片上传接口上传失败，可更改为自己的服务器接口'\r\n                });\r\n            },\r\n                    //选择父类\r\n            handleChange(value){\r\n    \r\n                this.form.categories=value;\r\n              \r\n            }\r\n\r\n        },\r\n        created(){\r\n            this.cropImg = this.defaultSrc;\r\n            \r\n             let articleid = localStorage.getItem('article_id');\r\n          \r\n            //查询所有分类\r\n            Axios.get(\"/api/category/tree\").then((response)=>{\r\n            this.options=response.data;\r\n\r\n                //回选分类\r\n                Axios.get(\"/api/category/article/\"+articleid).then((response)=>{\r\n                    this.form.categories=[2];\r\n                })\r\n            \r\n            })\r\n\r\n            //查询文章\r\n            Axios.get(\"/api/article/\"+articleid).then((response)=>{\r\n                this.form=response.data.data;\r\n                this.cropImg=response.data.data.coverphoto;\r\n                this.content=response.data.data.content;\r\n\r\n            \r\n            })\r\n\r\n           \r\n        }\r\n    }\r\n</script>\r\n<style scoped>\r\n    .editor-btn{\r\n        margin-top: 20px;\r\n    }\r\n</style>\r\n<style scoped>\r\n    .content-title{\r\n        font-weight: 400;\r\n        line-height: 50px;\r\n        margin: 10px 0;\r\n        font-size: 22px;\r\n        color: #1f2f3d;\r\n    }\r\n    .pre-img{   \r\n        width: 100px;\r\n        height: 100px;\r\n        background: #f8f8f8;\r\n        border: 1px solid #eee;\r\n        border-radius: 5px;\r\n    }\r\n    .crop-demo{\r\n        display: flex;\r\n        align-items: flex-end;\r\n    }\r\n    .crop-demo-btn{\r\n        position: relative;\r\n        width: 100px;\r\n        height: 40px;\r\n        line-height: 40px;\r\n        padding: 0 20px;\r\n        margin-left: 30px;\r\n        background-color: #409eff;\r\n        color: #fff;\r\n        font-size: 14px;\r\n        border-radius: 4px;\r\n        box-sizing: border-box;\r\n    }\r\n    .crop-input{\r\n        position: absolute;\r\n        width: 100px;\r\n        height: 40px;\r\n        left: 0;\r\n        top: 0;\r\n        opacity: 0;\r\n        cursor: pointer;\r\n    }\r\n</style>"]}]}